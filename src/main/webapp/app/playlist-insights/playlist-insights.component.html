<div class="playlist-insights root">
  <h1>Playlist Insights</h1>

  <div class="row">
    <br />

    <form (ngSubmit)="sendLink()" [formGroup]="urlForm">
      <label class="form-label" for="name"> Playlist URL </label>

      <div class="searchBar">
        <input
          type="text"
          class="form-control"
          id="name"
          name="link-input"
          formControlName="name"
          placeholder="Paste the link to a public Spotify playlist here..."
          [(ngModel)]="linkInput"
          required
        />

        <button type="submit" id="submit-link" data-cy="entityCreateSaveButton" class="btn btn-primary" [disabled]="linkInput === ''">
          Go!
        </button>
      </div>
    </form>
  </div>

  <br />

  <div class="row" *ngIf="pulledData">
    <p class="lead">
      Viewing insights for: <b>{{ response?.playlistTitle }}</b>
    </p>

    <br />

    <div class="row">
      <div class="columnA">
        <div class="statBox">
          <h3>Valence</h3>
          <div class="progressBarOutside">
            <div
              class="progressBarInside"
              style="background: rgb(178, 55, 236, 1)"
              [ngStyle]="{
                'width.%': valenceValue
              }"
            ></div>
          </div>
          <h3>Energy</h3>
          <div class="progressBarOutside">
            <div
              class="progressBarInside"
              style="background: rgb(255, 178, 25, 1)"
              [ngStyle]="{
                'width.%': energyValue
              }"
            ></div>
          </div>
          <h3>Acousticness</h3>
          <div class="progressBarOutside">
            <div
              class="progressBarInside"
              style="background: rgb(75, 163, 195, 1)"
              [ngStyle]="{
                'width.%': acousticnessValue
              }"
            ></div>
          </div>
          <h3>Danceability</h3>
          <div class="progressBarOutside">
            <div
              class="progressBarInside"
              style="background: rgb(234, 0, 43, 1)"
              [ngStyle]="{
                'width.%': danceabilityValue
              }"
            ></div>
          </div>
        </div>

        <div class="statBox">
          <div class="songCard">
            <img [src]="response?.happiestSong?.songImageURL" [alt]="'Album artwork for ' + response?.happiestSong?.songTitle" />
            <p>This playlist's <b>happiest song</b> is {{ response?.happiestSong?.songTitle }}</p>
          </div>
          <div class="songCard">
            <img [src]="response?.energeticSong?.songImageURL" [alt]="'Album artwork for ' + response?.energeticSong?.songTitle" />
            <p>This playlist's <b>most energetic song</b> is {{ response?.energeticSong?.songTitle }}</p>
          </div>
          <div class="songCard">
            <img [src]="response?.sumsUpSong?.songImageURL" [alt]="'Album artwork for ' + response?.sumsUpSong?.songTitle" />
            <p>The <b>song that sums this playlist up</b> is {{ response?.sumsUpSong?.songTitle }}</p>
          </div>
          <div class="songCard">
            <img [src]="response?.anomalousSong?.songImageURL" [alt]="'Album artwork for ' + response?.anomalousSong?.songTitle" />
            <p>This playlist's <b>most anomalous song</b> {{ response?.anomalousSong?.songTitle }}</p>
          </div>
        </div>
      </div>

      <div class="columnB">
        <div class="statBox">
          <ngx-charts-pie-chart
            [view]="[700, 300]"
            [results]="artistsPieChart"
            [legendPosition]="LegendPosition.Right"
            [legend]="true"
            [legendTitle]="artistsPieChartTitle"
            [scheme]="pieSchemeA"
          >
          </ngx-charts-pie-chart>
        </div>
        <div class="statBox">
          <ngx-charts-bar-vertical
            [results]="timePeriodBar"
            [view]="[500, 350]"
            [showXAxisLabel]="true"
            [showYAxisLabel]="true"
            [rotateXAxisTicks]="true"
            [xAxis]="true"
            [yAxis]="true"
            [showGridLines]="false"
            [xAxisLabel]="xaxisLabelBar"
            [yAxisLabel]="yaxisLabelBar"
            [scheme]="pieSchemeA"
          >
          </ngx-charts-bar-vertical>
        </div>
      </div>
    </div>
  </div>
</div>
